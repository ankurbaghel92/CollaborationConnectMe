"use strict"

app.factory('ChatForumServices',function($q,$timeout){
	
	console.log("Starting ==>  ChatForumServices")
	
	var service = {};
	
	var listner = $q.defer();
	
	var socket = {
					client : null,
					stomp : null
				}
	
	var messageIds = [];
	
	service.reConnect = 30000;
	
	service.socketURL = 'collaborationback/chat_forum';
	
	service.chatTopic = '/topic/message';
	
	service.chatBroker = 'app/chat_forum';
	
	service.receive = function()
	{
		console.log("ChatForumServices ==> Starting receive function()")

		console.log("ChatForumServices ==> Ending receive function()")

		return listner.promise;
	}
	
	serivce.send = function(message)
	{
		console.log("ChatForumServices ==> Starting send function()")

		var id = Math.floor(Math.random()*10000000);
		
		socket.stomp.send(service.chatBroker,{priority : 9},JSON.stringify({
			message : message,
			id : id
		}));
		
		messageIds.push(id);
		
		console.log("ChatForumServices ==> Ending send function()")

	}
	
	
	
})