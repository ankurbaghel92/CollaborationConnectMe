'use strict'

app.controller('FriendController',['UserServices','FriendServices','$rootScope','$scope','$location',
                               function(UserServices,FriendServices,$rootScope,$scope,$location){
	
	$scope.friendmessage="Message From Friend Controller"
		
		console.log("Starting ==>  FriendController")

		
		var self = this;
		
		self.friend = {Id:'',emailId : '',friendEmailId : '',status : '',IsOnline : '' };
		
		self.friends = [];
		
		
		self.user = {username:'',fname : '', lname : '', emailId : '', password : '', conPassword : '', mobile : '', role : '', isOnline : '', status : '', errorCode : '',
				 errorMessage : '', gender : '', reason : ''	};
	
	    self.users = [];
	    
	    
	    
	    self.fetchAllUsers = function(){
			console.log("FriendController ==> Starting fetchAllUsers function()")
			UserServices.fetchAllUsers().then
			    (
						function(d){
							self.users=d;
							console.log("FriendController ==> Ending fetchAllUsers function()")

						},
						function(errResponse)
						{
							console.error("Error  While Getting all the Users detials,.,.,.")
							console.log("FriendController ==> Ending fetchAllUsers function()")

						}
				)
		};//end of fetchAllUsers function()
	
		self.fetchAllUsers()

	
		

		 self.sendFriendRequest = function (username){

			console.log("FriendController ==> Starting sendFriendRequest function()")

			console.log(self.user.emailId)
			console.log(friendEmailId)

			FriendServices.sendFriendRequest(username).then
			(
					function(d)
					{
						self.friend=d;
						alert(self.friend.errorMessage)
						console.log("FriendController ==> Ending sendFriendRequest function()")

					},
					function(errResponse)
					{
						console.error("Error  While Sending Friend Request")
						console.log("FriendController ==> Ending sendFriendRequest function()")

					}
			)
				
		},
		

		
		
		self.send = function(Friendusername)
		{
			console.log(username)
			console.log(self.user.username)
			self.sendFriendRequest(username)
		}
		
		self.acceptFriendRequest = function(friendEmailId)
		{
			console.log("FriendController ==> Starting acceptFriendRequest function()")

			FriendServices.acceptFriendRequest(friendEmailId).then
			(
					
					function(d)
					{
						self.friend=d;

						console.log("FriendController ==> Ending acceptFriendRequest function()")

						alert(self.friend.errorMessage)
					},
					
					function(errResponse)
					{
						
						console.error("Error  While Accepting Friend Request")
						console.log("FriendController ==> Ending acceptFriendRequest function()")

					}
					
			)
		}

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
}])